<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Jamaica Decision 2025 — Live Results</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    :root {
      --jlp: #2e8b57;
      --pnp: #ff8c00;
      --other: #6066f2;
      --border: #e5e7eb;
      --bg: #fff;
      --text: #18181b;
      --accent: #2563eb;
      --shadow: 0 2px 14px rgba(0,0,0,.07);
      --winner-check: #18c963;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .header {
      display: flex;
      align-items: center;
      gap: 18px;
      padding: 18px 24px 16px 24px;
      border-bottom: 1.5px solid var(--border);
      background: var(--bg);
      font-size: 1.15rem;
      font-weight: bold;
    }
    .brand { font-size: 1.35em; letter-spacing: 1.5px; color: var(--accent);}
    /* Progress bar */
    .progress-wrap {
      margin: 0 auto;
      padding: 18px 0 12px 0;
      background: #f6f8fa;
      border-bottom: 1.5px solid var(--border);
      box-shadow: var(--shadow);
    }
    .race-bar {
      width: 98vw;
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      gap: 2px;
      height: 32px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 8px #0001;
      background: #d4d4d8;
      border: 1px solid #e5e7eb;
      position: relative;
    }
    .race-seg {
      flex: 1 1 0px;
      min-width: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform .12s;
      font-size: .95em;
      font-weight: 700;
      color: #fff;
      border-right: 1px solid #fff2;
      position: relative;
    }
    .race-seg:last-child { border-right: none; }
    .race-seg.jlp { background: var(--jlp);}
    .race-seg.pnp { background: var(--pnp);}
    .race-seg.other { background: var(--other);}
    .race-seg.focused, .race-seg:hover {
      outline: 2.5px solid var(--accent);
      z-index: 1;
      transform: scale(1.10);
    }
    .race-labels {
      width: 98vw;
      max-width: 1280px;
      margin: 8px auto 0 auto;
      display: flex;
      justify-content: space-between;
      font-size: .98em;
      font-weight: bold;
      color: #64748b;
    }
    .race-labels span:first-child { color: var(--jlp);}
    .race-labels span:last-child { color: var(--pnp);}
    /* Grid of battlegrounds */
    .constituency-wrap {
      max-width: 1340px;
      margin: 30px auto 24px auto;
      padding: 0 20px;
    }
    .battleground-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 22px;
    }
    .battle-card {
      border: 2.5px solid var(--border);
      border-radius: 16px;
      padding: 17px 18px 12px 18px;
      background: #fff;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      min-height: 110px;
      transition: border-color 0.15s;
      cursor: pointer;
      position: relative;
    }
    .battle-card.jlp { border-color: var(--jlp);}
    .battle-card.pnp { border-color: var(--pnp);}
    .battle-card.other { border-color: var(--other);}
    .battle-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 1.07em;
      font-weight: 800;
      margin-bottom: 4px;
    }
    .battle-name {
      flex: 1;
      color: var(--accent);
      letter-spacing: .05em;
      font-size: 1.02em;
      font-weight: 800;
    }
    .battle-winner {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: 1.01em;
      background: #e0fcef;
      color: var(--jlp);
      border-radius: 99px;
      padding: 2px 10px 2px 7px;
      font-weight: 800;
      border: 1.5px solid #bbf7d0;
      box-shadow: 0 2px 5px #2e8b5735;
    }
    .battle-card.pnp .battle-winner { background: #fff7ed; color: var(--pnp); border-color: #fed7aa;}
    .battle-card.other .battle-winner { background: #f1f5f9; color: var(--other); border-color: #dbeafe;}
    .winner-check {
      font-size: 1.2em;
      color: var(--winner-check);
    }
    .candidates-list {
      margin-top: 7px;
      display: flex;
      flex-direction: column;
      gap: 7px;
    }
    .candidate-row {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1em;
      font-weight: 600;
    }
    .candidate-party {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #e2e8f0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #fff;
      font-size: .97em;
      box-shadow: 0 1px 2px #0001;
    }
    .jlp .candidate-party { background: var(--jlp);}
    .pnp .candidate-party { background: var(--pnp);}
    .other .candidate-party { background: var(--other);}
    .candidate-name { flex: 1;}
    .candidate-votes { font-variant-numeric: tabular-nums; text-align: right;}
    .candidate-pct { font-size: .96em; margin-left: 8px; color: #64748b;}
    .battle-footer {
      margin-top: 9px;
      font-size: .94em;
      color: #64748b;
      font-weight: 600;
      display: flex;
      gap: 18px;
      justify-content: space-between;
    }
    .battle-card.focused,
    .battle-card:hover {
      border-color: var(--accent);
      z-index: 2;
      box-shadow: 0 4px 28px #2563eb18;
    }
    /* Responsive */
    @media (max-width: 720px) {
      .race-bar, .race-labels { width: 100vw; max-width: 100vw; }
      .constituency-wrap { padding: 0 3vw; }
    }
    /* Right sidebars, ticker etc. can be styled and added below as needed */
  </style>
</head>
<body>
  <div class="header">
    <span class="brand">Jamaica Decision 2025</span>
    <span style="font-size:1.1em;color:#999;font-weight:500;margin-left:1.2em">Live Results</span>
  </div>
  <!-- RACE TO 32 MAJORITY BAR -->
  <section class="progress-wrap">
    <div class="race-bar" id="raceBar"></div>
    <div class="race-labels">
      <span id="lblJLP"></span>
      <span>Race to 32</span>
      <span id="lblPNP"></span>
    </div>
  </section>
  <!-- MAIN GRID -->
  <div class="constituency-wrap">
    <div class="battleground-grid" id="constituencyGrid"></div>
  </div>
  <!-- Right panels, etc. can go here... -->
  <script>
    // --- MOCK DATA FOR DEMO ---
    const SAMPLE_CONSTITUENCIES = [
      { num: 1, name: "Kingston East & Port Royal", winner: "JLP", winnerName: "Philip Paulwell", winnerVotes: 5100, candidates: [
        {name: "Philip Paulwell", party: "JLP", votes: 5100, pct: 55.2},
        {name: "Venesha Phillips", party: "PNP", votes: 4150, pct: 44.8},
      ]},
      { num: 2, name: "Kingston Central", winner: "PNP", winnerName: "Ronald Thwaites", winnerVotes: 4744, candidates: [
        {name: "Ronald Thwaites", party: "PNP", votes: 4744, pct: 53.3},
        {name: "Donovan Williams", party: "JLP", votes: 4159, pct: 46.7},
      ]},
      { num: 3, name: "Kingston West", winner: "JLP", winnerName: "Desmond McKenzie", winnerVotes: 6201, candidates: [
        {name: "Desmond McKenzie", party: "JLP", votes: 6201, pct: 68.2},
        {name: "Patricia Duncan Sutherland", party: "PNP", votes: 2892, pct: 31.8},
      ]},
      { num: 4, name: "St. Andrew Eastern", winner: "PNP", winnerName: "Julian Robinson", winnerVotes: 5981, candidates: [
        {name: "Julian Robinson", party: "PNP", votes: 5981, pct: 54.1},
        {name: "Fayval Williams", party: "JLP", votes: 5080, pct: 45.9},
      ]},
      // ...add up to 32 or 63, but for demo let's have 10
      { num: 5, name: "St. Andrew Western", winner: "JLP", winnerName: "Anthony Hylton", winnerVotes: 5900, candidates: [
        {name: "Anthony Hylton", party: "JLP", votes: 5900, pct: 53.5},
        {name: "Paul Buchanan", party: "PNP", votes: 5122, pct: 46.5},
      ]},
      { num: 6, name: "St. Andrew North Central", winner: "PNP", winnerName: "Karl Samuda", winnerVotes: 5240, candidates: [
        {name: "Karl Samuda", party: "PNP", votes: 5240, pct: 57.9},
        {name: "Natalie Neita", party: "JLP", votes: 3815, pct: 42.1},
      ]},
      { num: 7, name: "St. Catherine North", winner: "PNP", winnerName: "Leslie Campbell", winnerVotes: 5050, candidates: [
        {name: "Leslie Campbell", party: "PNP", votes: 5050, pct: 50.6},
        {name: "Fitz Jackson", party: "JLP", votes: 4924, pct: 49.4},
      ]},
      { num: 8, name: "St. Catherine South", winner: "JLP", winnerName: "Fitz Jackson", winnerVotes: 5700, candidates: [
        {name: "Fitz Jackson", party: "JLP", votes: 5700, pct: 51.7},
        {name: "Colin Fagan", party: "PNP", votes: 5333, pct: 48.3},
      ]},
      { num: 9, name: "Manchester Central", winner: "PNP", winnerName: "Peter Bunting", winnerVotes: 5985, candidates: [
        {name: "Peter Bunting", party: "PNP", votes: 5985, pct: 53.9},
        {name: "Rhoda Moy Crawford", party: "JLP", votes: 5112, pct: 46.1},
      ]},
      { num: 10, name: "Manchester North Western", winner: "JLP", winnerName: "Mikael Phillips", winnerVotes: 6100, candidates: [
        {name: "Mikael Phillips", party: "JLP", votes: 6100, pct: 56.5},
        {name: "Damion Crawford", party: "PNP", votes: 4700, pct: 43.5},
      ]},
    ];
    // Map party key for style
    function partyClass(p) {
      if (!p) return 'other';
      const x = p.toLowerCase();
      if (x === 'jlp') return 'jlp';
      if (x === 'pnp') return 'pnp';
      return 'other';
    }
    // --- Race-to-majority segmented bar ---
    function renderRaceBar(data) {
      const bar = document.getElementById('raceBar');
      bar.innerHTML = '';
      let jlpSeats = 0, pnpSeats = 0;
      data.forEach((c, idx) => {
        if (partyClass(c.winner) === 'jlp') jlpSeats++;
        else if (partyClass(c.winner) === 'pnp') pnpSeats++;
        const seg = document.createElement('div');
        seg.className = 'race-seg ' + partyClass(c.winner);
        seg.title = `#${c.num} - ${c.name}\nWinner: ${c.winnerName} (${c.winner})`;
        seg.innerHTML = `<span style="font-size:.93em">${c.num}</span>`;
        seg.onclick = () => {
          // Scroll to battleground card
          const target = document.querySelector(`.battle-card[data-num="${c.num}"]`);
          if (target) target.scrollIntoView({behavior:'smooth', block:'center'});
          document.querySelectorAll('.battle-card').forEach(x=>x.classList.remove('focused'));
          if (target) target.classList.add('focused');
          // Highlight bar
          document.querySelectorAll('.race-seg').forEach(x=>x.classList.remove('focused'));
          seg.classList.add('focused');
          setTimeout(()=>seg.classList.remove('focused'), 2200);
          setTimeout(()=>target.classList.remove('focused'), 2300);
        };
        bar.appendChild(seg);
      });
      // Labels
      document.getElementById('lblJLP').textContent = `JLP: ${jlpSeats}`;
      document.getElementById('lblPNP').textContent = `PNP: ${pnpSeats}`;
    }
    // --- Modern Battleground Block Grid ---
    function renderGrid(data) {
      const grid = document.getElementById('constituencyGrid');
      grid.innerHTML = '';
      data.forEach(c => {
        const card = document.createElement('div');
        card.className = `battle-card ${partyClass(c.winner)}`;
        card.dataset.num = c.num;
        card.innerHTML = `
          <div class="battle-header">
            <span class="battle-name">${c.name} <span style="font-size:.91em;color:#64748b;">(#${c.num})</span></span>
            <span class="battle-winner">
              <span class="winner-check">✓</span>
              ${c.winnerName} (${c.winner})
            </span>
          </div>
          <div class="candidates-list">
            ${c.candidates.map(can=>`
              <div class="candidate-row ${partyClass(can.party)}">
                <span class="candidate-party">${can.party[0]}</span>
                <span class="candidate-name">${can.name}</span>
                <span class="candidate-votes">${can.votes.toLocaleString()}</span>
                <span class="candidate-pct">${can.pct}%</span>
              </div>
            `).join('')}
          </div>
          <div class="battle-footer">
            <span>Winner: <b style="color:var(--accent)">${c.winnerName}</b></span>
            <span>Total votes: <b>${c.candidates.reduce((s,x)=>s+x.votes,0).toLocaleString()}</b></span>
          </div>
        `;
        card.onclick = () => {
          // Focus highlight (for mobile/desktop)
          document.querySelectorAll('.battle-card').forEach(x=>x.classList.remove('focused'));
          card.classList.add('focused');
          setTimeout(()=>card.classList.remove('focused'), 1700);
        };
        grid.appendChild(card);
      });
    }
    // --- Render all ---
    renderRaceBar(SAMPLE_CONSTITUENCIES);
    renderGrid(SAMPLE_CONSTITUENCIES);
  </script>
</body>
</html>
